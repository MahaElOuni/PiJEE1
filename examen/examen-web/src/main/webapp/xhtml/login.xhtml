<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<ui:composition  xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:fb="http://www.facebook.com/2008/fbml"
      template="/WEB-INF/template/template0.xhtml"> 
      
      
    <ui:define name="title">
		<title>Login</title>
	</ui:define> 
	<ui:define name="content">
	
	<!--================Home Banner Area =================-->
        <section class="banner_area">
            <div class="banner_inner d-flex align-items-center">
            	<div class="overlay bg-parallax" data-stellar-ratio="0.9" data-stellar-vertical-offset="0" data-background=""></div>
				<div class="container">
					<div class="banner_content text-center">
						<div class="page_link">
							<a href="${facesContext.externalContext.requestContextPath}/xhtml/index.xhtml">Home</a>
							<a href="${facesContext.externalContext.requestContextPath}/xhtml/login.xhtml">Login</a>
						</div>
						<h2>LOGIN</h2>
					</div>
				</div>
            </div>
        </section>
        <!--================End Home Banner Area =================-->
	<br /><br />
	<div class="row">
	
    <div class="col-md-12">
        <div class="card" style="max-width:500px;margin:auto; align-content:center;align-self:center;">
        
         <h5 class="card-header info-color white-text text-center py-4" style="background-color:	indigo">
                    <strong style="color:white">WELCOME DEAR VISITOR</strong>
                </h5>
                <br />
        
        <div class="card-body px-lg-5 pt-0">
                    <!-- Form -->
                    <form class="text-center" action="">
                            
                            <!-- Email -->
                            <div class="md-form">
                            	<!-- <input type="email" id="materialLoginFormEmail" class="form-control"/>
                            	<label for="materialLoginFormEmail">E-mail</label>-->
                            	<h:outputText value="Login" /> <h:inputText  class="form-control" value="#{loginBean.login}" />
                            </div>
                            <br></br>
                            <!-- Password -->
                            <div class="md-form">
                            	 <!--<input type="password" id="materialLoginFormPassword" class="form-control"/>
                            	<label for="materialLoginFormPassword">Password</label> -->
                            	<h:outputText value="Password" /> <h:inputSecret class="form-control" value="#{loginBean.password}" />
                            </div>
                            <br></br>
        				   <!-- <button class="main_btn" type="submit" style="margin-left:130px" >Sign in</button>-->
        				    <h:commandButton class="main_btn" id="btn" value="Sign in" action="#{loginBean.doLogin()}" />
        				    <h:message for="btn"/>
        				    
        				    <hr></hr>
        				    <div class="col-md-12">
        				     <!-- Facebook Login -->       				    
                            	<script>
  									// This is called with the results from from FB.getLoginStatus().
  										function statusChangeCallback(response) {
   											 console.log('statusChangeCallback');
   											 console.log(response);
  											  if (response.status === 'connected') {
    											  // Logged into your app and Facebook.
     													 testAPI();
    										} else {
     											 // The person is not logged into your app or we are unable to tell.
    													  document.getElementById('status').innerHTML = 'Please log ' +'into this app.';}}
  										function checkLoginState() {
  											  FB.getLoginStatus(function(response) {
    										  statusChangeCallback(response);});}
										 window.fbAsyncInit = function() {
   											 FB.init({
     										 appId      : '319368785411432',
     										 cookie     : true,  // enable cookies to allow the server to access 
                        						  // the session
     										 xfbml      : true,  // parse social plugins on this page
    									  version    : 'v3.3' // The Graph API version to use for the call
        									  });
    									 FB.getLoginStatus(function(response) {
    										statusChangeCallback(response); }); };

  										// Load the SDK asynchronously
 									 (function(d, s, id) {
   										 var js, fjs = d.getElementsByTagName(s)[0];
   										 if (d.getElementById(id)) return;
  											  js = d.createElement(s); js.id = id;
  											  js.src = "https://connect.facebook.net/en_US/sdk.js";
  											  fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));
									 function testAPI() {
  										  console.log('Welcome!  Fetching your information.... ');
  									  FB.api('/me?fields=name,email', function(response) {
      								     console.log('Successful login for: ' + response.name);
  											document.getElementById('status').innerHTML =
       											 'Thanks for logging in, ' + response.name +'<a href="${facesContext.externalContext.requestContextPath}/xhtml/home.xhtml">Continue</a>'+ '!'; });}
							</script>
 								<!--Below we include the Login Button social plugin. This button uses the JavaScript SDK to present a graphical Login button that triggers the FB.login() function when clicked.-->
								<fb:login-button scope="public_profile,email" onlogin="checkLoginState();"> </fb:login-button>
								<div id="status"></div>
								
							 <!-- Google Login -->    	
 							<html>
								<head>
  									 <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta>
   								   <script src="https://apis.google.com/js/platform.js"></script>
 									 <meta name="google-signin-client_id" content="523629142846-tt32ne1dhrvsfrpjjt6pu4jcsmet8nt1.apps.googleusercontent.com" ></meta>
								</head>
								
								<body>
   								    <div class="g-signin2" data-onsuccess="onSignIn" id="myP"></div>
      									<img id="myImg" /><br></br>
      									<p id="name"></p>
     								 <div id="status"></div>
   									<script type="text/javascript">
   										   function onSignIn(googleUser) {
     											 // window.location.href='success.jsp';
      												var profile = googleUser.getBasicProfile();
    											    var imagurl=profile.getImageUrl();
    											    var name=profile.getName();
      												var email=profile.getEmail();
     												 document.getElementById("myImg").src = imagurl;
      												 document.getElementById("name").innerHTML = name;
    											     document.getElementById("myP").style.visibility = "hidden";
                                                     document.getElementById("status").innerHTML = 'Thanks for logging in, ' 
                                                         + response.name +'<a href="${facesContext.externalContext.requestContextPath}/xhtml/home.xhtml">Continue</a>'+ '!';}
   									</script>
								</body>
							</html>		    			
        				    </div>	
                     </form>
        
        </div>
        </div>
        </div>
	   </div>
	
	</ui:define>
</ui:composition>
